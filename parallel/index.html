<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="RPI's Optimal Design Lab">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Code Parallelization - PDESolver.jl (Ticon)</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../assets/Documenter.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Code Parallelization";
    var mkdocs_page_input_path = "parallel.md";
    var mkdocs_page_url = "/parallel/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PDESolver.jl (Ticon)</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../interfaces/">Code Interfaces</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Code Parallelization</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#parallel-overview">Parallel Overview</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#explicate-time-marching">Explicate Time Marching</a></li>
        
            <li><a class="toctree-l3" href="#newtons-method">Newtons Method</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">PDESolver</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../pdesolver/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../pdesolver_user/">PDESolver User Interface</a>
                </li>
                <li class="">
                    
    <a class="" href="../pdesolver_physics/">PDESolver Physics Interface</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Solver</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../solver/Readme/">Introduction</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Advection</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/advection/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/types/">Datatypes</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/volume/">Volume Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/flux/">Face Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/bc/">Boundary Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/ic/">Initial Conditions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/source/">Source Term</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/common/">Common Functions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/adjoint/">Adjoint</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/advection/boundary_functional/">Boundary Functional</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Euler</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/euler/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/types/">Datatypes</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/volume/">Volume Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/flux/">Face Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/bc/">Boundary Integrals</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/ic/">Initial Conditions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/source/">Source Term</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/common/">Common Functions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/conversion/">Conversion</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/flux_functions/">Numerical Flux Functions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/stabilization/">Stabilization</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/adjoint/">Adjoint</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/boundary_functional/">Boundary Functional</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../solver/euler/misc/">Misc</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../solver/simpleODE/simpleODE/">Simple ODE</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../input/input/">Input</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Nonlinear Solvers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../NonlinearSolvers/nonlinearsolvers/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../NonlinearSolvers/steady/">Steady</a>
                </li>
                <li class="">
                    
    <a class="" href="../NonlinearSolvers/unsteady/">Unsteady</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Utils</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Utils/Utils/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../Utils/parallel/">Parallel Constructs</a>
                </li>
                <li class="">
                    
    <a class="" href="../Utils/projections/">Projections</a>
                </li>
                <li class="">
                    
    <a class="" href="../Utils/logging/">Logging</a>
                </li>
                <li class="">
                    
    <a class="" href="../Utils/io/">Input/Output</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">PDESolver.jl (Ticon)</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Code Parallelization</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/OptimalDesignLab/PDESolver.jl/edit/master/docs/parallel.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a id='Parallel-Overview-1'></a></p>
<h1 id="parallel-overview">Parallel Overview</h1>
<p>This document describes how PDEs are solved in parallel.</p>
<p>In general, the mesh is partitioned and each part is assigned to a different MPI process. Each element is owned by exactly one process.  During  initialization, the mesh constructor on each process figures out which other processes have elements that share a face (edge in 2D) with local elements. It counts how many faces and elements are shared (a single element could have multiple faces on the parallel boundary), and assigns local number to both the elements and the degrees of freedom on the elements.  The non-local elements  are given numbers greater than <code>numEl</code>, the number of local elements.   The degrees of freedom are re-numbered such that newly assigned dof number plus the <code>dof_offset</code> for the current process equals the global dof number, which is defined by the local dof number assigned by the process that owns the element.  As a  result, dof numbers for elements that live on processes with lower ranks will be negative.</p>
<p>As part of counting the number of shared faces and elements, 3 arrays are formed: <code>bndries_local</code>, <code>bndries_remote</code>, and <code>shared_interfaces</code> which  describe the shared faces from the local side, the remote side, and a  unified view of the interface, respectively.  This allows treating the shared faces like either a special kind of boundary condition or a proper  interface, similar to the interior interfaces.</p>
<p>There are 2 modes of parallel operation, one for explicit time marching and the other for Newton's method.</p>
<p><a id='Explicate-Time-Marching-1'></a></p>
<h2 id="explicate-time-marching">Explicate Time Marching</h2>
<p>In this mode, each process each process sends the solution values at the  shared faces to the other processes.  Each process then evaluates the residual using the received values and updates the solution.</p>
<p>The function <code>exchangeFaceData</code> is designed to perform the sending and  receiving of data.  Non-blocking communications are used, and the function does not wait for the communication to finish before returning.  The  MPI_Requests for the sends and receives are stored in the appropriate fields of the mesh.  It is the responsibility of each physics module call  <code>exchangeFaceData</code> and to wait for the communication to finish before using the data.  Because the receives could be completed in any order, it is  recommended to use <code>MPI_Waitany</code> to wait for the first receive to complete,  do as many computations as possible on the data, and then call <code>MPI_Waitany</code> again for the next receive.</p>
<p><a id='Newtons-Method-1'></a></p>
<h2 id="newtons-method">Newtons Method</h2>
<p>For Newton's method, each process sends the solution values for all the  elements on the shared interface at the beginning of a Jacobian calculation.  Each process is then responsible for perturbing the solutions values of both  the local and non-local elements.  The benefit of this is that parallel  communication is required once per Jacobian calculation, rather than once  per residual evaluation as with the explicit time marching mode.</p>
<p>The function <code>exchangeElementData</code> copies the data from the shared elements into the send buffer and sends it, and also posts the corresponding receives. It does not wait for the communications to finish before returning.   The function is called by Newton's method after a new solution is calculated, so the physics module does not have to do it, but the physics module does  have to wait for the receives to finish before using the data.  This is  necessary to allow overlap of the communication with computation.  As  with the explicit time marching mode, use of <code>MPI_Waitany</code> is recommended. </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pdesolver/" class="btn btn-neutral float-right" title="Introduction">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../interfaces/" class="btn btn-neutral" title="Code Interfaces"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/OptimalDesignLab/PDESolver.jl" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../interfaces/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../pdesolver/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../assets/mathjaxhelper.js"></script>

</body>
</html>
