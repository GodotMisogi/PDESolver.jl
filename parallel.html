<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Code Parallelization · PDESolver.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="../versions.js"></script></head><body><nav class="toc"><h1>PDESolver.jl</h1><form class="search" action="search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">PDESolver Introduction</a></li><li><span class="toctext">Building PDESolver</span><ul><li><a class="toctext" href="build.html">Building PDESolver</a></li><li><a class="toctext" href="deps_readme.html">Build Options</a></li></ul></li><li><span class="toctext">DOC To be broken up or organized</span><ul><li><a class="toctext" href="interfaces.html">Code Interfaces</a></li><li class="current"><a class="toctext" href="parallel.html">Code Parallelization</a><ul class="internal"><li><a class="toctext" href="#Explicit-Time-Marching-1">Explicit Time Marching</a></li><li><a class="toctext" href="#Newton's-Method-1">Newton&#39;s Method</a></li></ul></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="examples/isentropic.html">Isentropic Vortex</a></li><li><a class="toctext" href="examples/unsteady.html">Unsteady Vortex</a></li></ul></li><li><span class="toctext">Frontend</span><ul><li><a class="toctext" href="pdesolver.html">Introduction</a></li><li><a class="toctext" href="pdesolver_user.html">PDESolver User Interface</a></li><li><a class="toctext" href="pdesolver_physics.html">PDESolver PhysicsInterface</a></li></ul></li><li><span class="toctext">Invocation</span><ul><li><a class="toctext" href="invocation/calling.html">Calling PDESolver</a></li><li><a class="toctext" href="invocation/interactive.html">Interactive Session (experimental)</a></li></ul></li><li><span class="toctext">Solver</span><ul><li><a class="toctext" href="solver/Readme.html">Overview of Physics Modules</a></li><li><a class="toctext" href="solver/misc.html">Assorted Function and Types</a></li><li><span class="toctext">Advection</span><ul><li><a class="toctext" href="solver/advection/advection.html">Introduction</a></li><li><a class="toctext" href="solver/advection/types.html">Datatypes</a></li><li><a class="toctext" href="solver/advection/volume.html">Volume Integrals</a></li><li><a class="toctext" href="solver/advection/flux.html">Face Integrals</a></li><li><a class="toctext" href="solver/advection/bc.html">Boundary Integrals</a></li><li><a class="toctext" href="solver/advection/ic.html">Initial Condition</a></li><li><a class="toctext" href="solver/advection/source.html">Source Term</a></li><li><a class="toctext" href="solver/advection/common.html">Common Functions</a></li><li><a class="toctext" href="solver/advection/adjoint.html">Adjoint</a></li><li><a class="toctext" href="solver/advection/boundary_functional.html">Boundary Functional</a></li></ul></li><li><span class="toctext">Euler</span><ul><li><a class="toctext" href="solver/euler/euler.html">Introduction</a></li><li><a class="toctext" href="solver/euler/types.html">Datatypes</a></li><li><a class="toctext" href="solver/euler/volume.html">Volume Integrals</a></li><li><a class="toctext" href="solver/euler/flux.html">Face Integrals</a></li><li><a class="toctext" href="solver/euler/bc.html">Boundary Integrals</a></li><li><a class="toctext" href="solver/euler/ic.html">Initial Conditions</a></li><li><a class="toctext" href="solver/euler/source.html">Source Term</a></li><li><a class="toctext" href="solver/euler/common.html">Common Functions</a></li><li><a class="toctext" href="solver/euler/conversion.html">Conversion</a></li><li><a class="toctext" href="solver/euler/flux_functions.html">Numerical Flux Functions</a></li><li><a class="toctext" href="solver/euler/stabilization.html">Stabilization</a></li><li><a class="toctext" href="solver/euler/adjoint.html">Adjoint</a></li><li><a class="toctext" href="solver/euler/boundary_functional.html">Boundary Functions</a></li><li><a class="toctext" href="solver/euler/misc.html">Misc</a></li></ul></li><li><span class="toctext">Simple ODE</span><ul><li><a class="toctext" href="solver/simpleODE/simpleODE.html">Main</a></li></ul></li></ul></li><li><span class="toctext">Input</span><ul><li><a class="toctext" href="input/input.html">Introduction</a></li></ul></li><li><span class="toctext">NonlinearSolvers</span><ul><li><a class="toctext" href="NonlinearSolvers/nonlinearsolvers.html">Introduction</a></li><li><a class="toctext" href="NonlinearSolvers/steady.html">Steady</a></li><li><a class="toctext" href="NonlinearSolvers/unsteady.html">Unsteady</a></li></ul></li><li><span class="toctext">Utils</span><ul><li><a class="toctext" href="Utils/Utils.html">Main</a></li><li><a class="toctext" href="Utils/parallel.html">Parallel Constructs</a></li><li><a class="toctext" href="Utils/projections.html">Projections</a></li><li><a class="toctext" href="Utils/logging.html">Logging</a></li><li><a class="toctext" href="Utils/io.html">Input/Output</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>DOC To be broken up or organized</li><li><a href="parallel.html">Code Parallelization</a></li></ul><a class="edit-page" href="https://github.com/OptimalDesignLab/PDESolver.jl/tree/b56cb4486ed31641647da6613ba5c3dc9c3f9fb3/docs/src/parallel.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Parallel-Overview-1" href="#Parallel-Overview-1">Parallel Overview</a></h1><p>This document describes how PDEs are solved in parallel.</p><p>In general, the mesh is partitioned and each part is assigned to a different MPI process. Each element is owned by exactly one process.  During  initialization, the mesh constructor on each process figures out which other processes have elements that share a face (edge in 2D) with local elements. It counts how many faces and elements are shared (a single element could have multiple faces on the parallel boundary), and assigns local number to both the elements and the degrees of freedom on the elements.  The non-local elements  are given numbers greater than <code>numEl</code>, the number of local elements.   The degrees of freedom are re-numbered such that newly assigned dof number plus the <code>dof_offset</code> for the current process equals the global dof number, which is defined by the local dof number assigned by the process that owns the element.  As a  result, dof numbers for elements that live on processes with lower ranks will be negative.</p><p>As part of counting the number of shared faces and elements, 3 arrays are formed: <code>bndries_local</code>, <code>bndries_remote</code>, and <code>shared_interfaces</code> which  describe the shared faces from the local side, the remote side, and a  unified view of the interface, respectively.  This allows treating the shared faces like either a special kind of boundary condition or a proper  interface, similar to the interior interfaces.</p><p>There are 2 modes of parallel operation, one for explicit time marching and the other for Newton&#39;s method.</p><h2><a class="nav-anchor" id="Explicit-Time-Marching-1" href="#Explicit-Time-Marching-1">Explicit Time Marching</a></h2><p>In this mode, each process each process sends the solution values at the  shared faces to the other processes.  Each process then evaluates the residual using the received values and updates the solution.</p><p>The function <code>exchangeFaceData</code> is designed to perform the sending and  receiving of data.  Non-blocking communications are used, and the function does not wait for the communication to finish before returning.  The  MPI_Requests for the sends and receives are stored in the appropriate fields of the mesh.  It is the responsibility of each physics module call  <code>exchangeFaceData</code> and to wait for the communication to finish before using the data.  Because the receives could be completed in any order, it is  recommended to use <code>MPI_Waitany</code> to wait for the first receive to complete,  do as many computations as possible on the data, and then call <code>MPI_Waitany</code> again for the next receive.</p><h2><a class="nav-anchor" id="Newton's-Method-1" href="#Newton's-Method-1">Newton&#39;s Method</a></h2><p>For Newton&#39;s method, each process sends the solution values for all the  elements on the shared interface at the beginning of a Jacobian calculation.  Each process is then responsible for perturbing the solutions values of both  the local and non-local elements.  The benefit of this is that parallel  communication is required once per Jacobian calculation, rather than once  per residual evaluation as with the explicit time marching mode.</p><p>The function <code>exchangeElementData</code> copies the data from the shared elements into the send buffer and sends it, and also posts the corresponding receives. It does not wait for the communications to finish before returning.   The function is called by Newton&#39;s method after a new solution is calculated, so the physics module does not have to do it, but the physics module does  have to wait for the receives to finish before using the data.  This is  necessary to allow overlap of the communication with computation.  As  with the explicit time marching mode, use of <code>MPI_Waitany</code> is recommended. </p><footer><hr/><a class="previous" href="interfaces.html"><span class="direction">Previous</span><span class="title">Code Interfaces</span></a><a class="next" href="examples/isentropic.html"><span class="direction">Next</span><span class="title">Isentropic Vortex</span></a></footer></article></body></html>
