<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Build Options · PDESolver.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PDESolver.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">PDESolver Introduction</a></li><li><span class="toctext">PDESolver Concepts</span><ul><li><a class="toctext" href="concepts/intro.html">Intro</a></li><li><a class="toctext" href="concepts/pumi.html">PUMI</a></li><li><a class="toctext" href="concepts/sbp.html">SBP</a></li></ul></li><li><span class="toctext">Building PDESolver</span><ul><li><a class="toctext" href="build.html">Building PDESolver</a></li><li class="current"><a class="toctext" href="deps_readme.html">Build Options</a><ul class="internal"><li><a class="toctext" href="#Regular-Packages-1">Regular Packages</a></li><li><a class="toctext" href="#Non-Standard-Packages-1">Non-Standard Packages</a></li><li><a class="toctext" href="#Manual-Installation-Process-1">Manual Installation Process</a></li><li><a class="toctext" href="#Environmental-Variables-1">Environmental Variables</a></li><li><a class="toctext" href="#Offline-Installation-1">Offline Installation</a></li><li><a class="toctext" href="#Logging-1">Logging</a></li><li><a class="toctext" href="#Known-Issues-1">Known Issues</a></li></ul></li></ul></li><li><span class="toctext">DOC To be broken up or organized</span><ul><li><a class="toctext" href="interfaces.html">Code Interfaces</a></li><li><a class="toctext" href="parallel.html">Code Parallelization</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="examples/isentropic.html">Isentropic Vortex</a></li><li><a class="toctext" href="examples/unsteady.html">Unsteady Vortex</a></li></ul></li><li><span class="toctext">Frontend</span><ul><li><a class="toctext" href="pdesolver.html">Introduction</a></li><li><a class="toctext" href="pdesolver_user.html">PDESolver User Interface</a></li><li><a class="toctext" href="pdesolver_physics.html">PDESolver Physics Interface</a></li><li><a class="toctext" href="pdesolver_structure.html">PDESolver Structure</a></li></ul></li><li><span class="toctext">Invocation</span><ul><li><a class="toctext" href="invocation/calling.html">Calling PDESolver</a></li><li><a class="toctext" href="invocation/interactive.html">Interactive Session (experimental)</a></li></ul></li><li><span class="toctext">Solver</span><ul><li><a class="toctext" href="solver/Readme.html">Overview of Physics Modules</a></li><li><a class="toctext" href="solver/misc.html">Assorted Function and Types</a></li><li><a class="toctext" href="solver/SolverCommon.html">Solver Common</a></li><li><span class="toctext">Advection</span><ul><li><a class="toctext" href="solver/advection/advection.html">Introduction</a></li><li><a class="toctext" href="solver/advection/types.html">Datatypes</a></li><li><a class="toctext" href="solver/advection/volume.html">Volume Integrals</a></li><li><a class="toctext" href="solver/advection/flux.html">Face Integrals</a></li><li><a class="toctext" href="solver/advection/bc.html">Boundary Integrals</a></li><li><a class="toctext" href="solver/advection/ic.html">Initial Condition</a></li><li><a class="toctext" href="solver/advection/source.html">Source Term</a></li><li><a class="toctext" href="solver/advection/common.html">Common Functions</a></li><li><a class="toctext" href="solver/advection/adjoint.html">Adjoint</a></li><li><a class="toctext" href="solver/advection/boundary_functional.html">Boundary Functional</a></li></ul></li><li><span class="toctext">Euler</span><ul><li><a class="toctext" href="solver/euler/euler.html">Introduction</a></li><li><a class="toctext" href="solver/euler/types.html">Datatypes</a></li><li><a class="toctext" href="solver/euler/volume.html">Volume Integrals</a></li><li><a class="toctext" href="solver/euler/volume_diff.html">Volume Integrals Jacobian</a></li><li><a class="toctext" href="solver/euler/flux.html">Face Integrals</a></li><li><a class="toctext" href="solver/euler/flux_diff.html">Face Integrals Jacobian</a></li><li><a class="toctext" href="solver/euler/faceElementIntegrals.html">Face Element Integrals</a></li><li><a class="toctext" href="solver/euler/bc.html">Boundary Integrals</a></li><li><a class="toctext" href="solver/euler/bc_diff.html">Boundary Integrals Jacobian</a></li><li><a class="toctext" href="solver/euler/ic.html">Initial Conditions</a></li><li><a class="toctext" href="solver/euler/source.html">Source Term</a></li><li><a class="toctext" href="solver/euler/common.html">Common Functions</a></li><li><a class="toctext" href="solver/euler/conversion.html">Conversion</a></li><li><a class="toctext" href="solver/euler/flux_functions.html">Numerical Flux Functions</a></li><li><a class="toctext" href="solver/euler/flux_functions_diff.html">Numerical Flux Functions Jacobian</a></li><li><a class="toctext" href="solver/euler/stabilization.html">Stabilization</a></li><li><a class="toctext" href="solver/euler/adjoint.html">Adjoint</a></li><li><a class="toctext" href="solver/euler/boundary_functional.html">Boundary Functional</a></li><li><a class="toctext" href="solver/euler/misc.html">Misc</a></li><li><a class="toctext" href="solver/euler/homotopy.html">Homotopy</a></li><li><a class="toctext" href="solver/euler/homotopy_diff.html">Homotopy Jacobian</a></li><li><a class="toctext" href="solver/euler/eigensystem.html">Eigensystem</a></li><li><a class="toctext" href="solver/euler/startup.html">Startup</a></li></ul></li><li><span class="toctext">Simple ODE</span><ul><li><a class="toctext" href="solver/simpleODE/simpleODE.html">Main</a></li></ul></li></ul></li><li><span class="toctext">Input</span><ul><li><a class="toctext" href="input/input.html">Introduction</a></li><li><a class="toctext" href="input/keys.html">Important Keys</a></li></ul></li><li><span class="toctext">LinearSolvers</span><ul><li><a class="toctext" href="linearsolvers/linearsolvers.html">Introduction</a></li><li><a class="toctext" href="linearsolvers/pc.html">Preconditioners</a></li><li><a class="toctext" href="linearsolvers/lo.html">Linear Operators</a></li><li><a class="toctext" href="linearsolvers/ls.html">Linear Solvers</a></li></ul></li><li><span class="toctext">NonlinearSolvers</span><ul><li><a class="toctext" href="NonlinearSolvers/nonlinearsolvers.html">Introduction</a></li><li><a class="toctext" href="NonlinearSolvers/steady.html">Steady</a></li><li><span class="toctext">Unsteady</span><ul><li><a class="toctext" href="NonlinearSolvers/unsteady/intro.html">Intro</a></li><li><a class="toctext" href="NonlinearSolvers/unsteady/rk4.html">Runge-Kutta</a></li><li><a class="toctext" href="NonlinearSolvers/unsteady/lserk.html">LSERK</a></li><li><a class="toctext" href="NonlinearSolvers/unsteady/cn.html">Crank-Nicolson</a></li><li><a class="toctext" href="NonlinearSolvers/unsteady/cn_uadj.html">Crank-Nicolson: Unsteady Adjoint</a></li></ul></li><li><a class="toctext" href="NonlinearSolvers/newton.html">Newton&#39;s Method</a></li><li><a class="toctext" href="NonlinearSolvers/jacobian.html">Jacobian Calculation</a></li><li><a class="toctext" href="NonlinearSolvers/jac_recalc.html">Jacobian Freezing</a></li><li><a class="toctext" href="NonlinearSolvers/residual_evaluation.html">Residual Evalution</a></li><li><a class="toctext" href="NonlinearSolvers/matrix.html">Matrix Interface</a></li><li><a class="toctext" href="NonlinearSolvers/newton_inner.html">Newton Inner</a></li></ul></li><li><span class="toctext">Utils</span><ul><li><a class="toctext" href="Utils/Utils.html">Main</a></li><li><a class="toctext" href="Utils/parallel.html">Parallel Constructs</a></li><li><a class="toctext" href="Utils/projections.html">Projections</a></li><li><a class="toctext" href="Utils/logging.html">Logging</a></li><li><a class="toctext" href="Utils/io.html">Input/Output</a></li><li><a class="toctext" href="Utils/checkpoint.html">Checkpointing</a></li><li><a class="toctext" href="Utils/misc.html">Misccellaneous</a></li></ul></li><li><span class="toctext">Testing</span><ul><li><a class="toctext" href="test/Testing.html">Introduction</a></li><li><a class="toctext" href="test/Readme.html">Local Testing</a></li><li><a class="toctext" href="test/Travis.html">CI Testing</a></li><li><a class="toctext" href="test/TestSystem.html">Test API</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Building PDESolver</li><li><a href="deps_readme.html">Build Options</a></li></ul><a class="edit-page" href="https://github.com/OptimalDesignLab/PDESolver.jl/blob/master/deps/README.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Build Options</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h1><p>PDESolver depends on several packages, some registered Julia packages, others  not.</p><h2><a class="nav-anchor" id="Regular-Packages-1" href="#Regular-Packages-1">Regular Packages</a></h2><p>Like any Julia package, most of the dependencies that are registered packages are listed in the <code>REQUIRE</code> file along with version numbers known to work. The Julia package manager is used to resolve any dependency conflicts with  other installed packages.</p><h2><a class="nav-anchor" id="Non-Standard-Packages-1" href="#Non-Standard-Packages-1">Non-Standard Packages</a></h2><p>The build system install dependencies that are not registered packages by manually  cloning their repositories and building them.  Commit hashes are used to  identify versions known to work.  The commits are checked out into a branch called <code>pdesolver_version</code>.</p><p>If a package is already installed, by default it will left alone (ie. the  specified commit will not be checked out).  This behavior can be overrided  by declaring certain environmental variables in the shell before launching  Julia (see below)</p><h2><a class="nav-anchor" id="Manual-Installation-Process-1" href="#Manual-Installation-Process-1">Manual Installation Process</a></h2><p>The build system can install packeges listed in the <code>REQUIRE</code> file manually, by  cloning the repository and checkout out a particular commit known to work. This will force the checking out of he commit and re-building of the package  even if it is already installed.</p><h2><a class="nav-anchor" id="Environmental-Variables-1" href="#Environmental-Variables-1">Environmental Variables</a></h2><ul><li><p><code>PDESOLVER_INSTALL_DEPS_MANUAL</code>: install the packages in the <code>REQUIRE</code> file</p></li></ul><p>manually.  If the package is already installed, does nothing (does not check out the specified version).</p><ul><li><p><code>PDESOLVER_FORCE_DEP_INSTALL_ALL</code>: forces the checkout and re-installation </p></li></ul><p>of the non-standard packages, even if already installed</p><ul><li><p><code>PDESOLVER_FORCE_DEP_INSTALL_pkg_name</code>: force the checkout and re-installation</p></li></ul><p>of the package named <code>pkg_name</code>.</p><p>For all these environmental variables, the value is not important, only the  existance of the variable.</p><p>After setting the required environment variables, either run <code>Pkg.build()</code> in the Julia REPL or have Julia execute the script <code>deps/build.jl</code>.</p><h2><a class="nav-anchor" id="Offline-Installation-1" href="#Offline-Installation-1">Offline Installation</a></h2><p>If the internet is not accessible from the machine where the code is to be  installed, it is possible to download the packages to a specified  directory on another machine and then copy them to the machine where they will be installed.  To do this, set the envinronmental variable  <code>PDESOLVER_BUNDLE_DEPS</code> to tell the build script to perform bundling instead of  installation, and set the path to the directory where the deps should be stored in the variable <code>PDESOLVER_PKGDIR</code>.</p><p>After running the build script, copy the contents of the <code>PDESOLVER_PKGDIR</code> to the package directory on the target machine, set <code>PDESOLVER_UNBUNDLE_DEPS</code>, and run the <code>PDESolver/build.jl</code>.</p><h2><a class="nav-anchor" id="Logging-1" href="#Logging-1">Logging</a></h2><p>The file <code>deps/install.log</code> is created and written to with the progress of the checkout process, including error information if a build fails. Because <code>Pkg.build</code> swallows errors, failures inside <code>Pkg.build</code> are not logged.</p><h2><a class="nav-anchor" id="Known-Issues-1" href="#Known-Issues-1">Known Issues</a></h2><h3><a class="nav-anchor" id="Stack-Smashing-1" href="#Stack-Smashing-1">Stack Smashing</a></h3><p>On Intel Skylake, there is a problem with reusing the symbolic factorization when using the sparse direct linar solver.  The error message looks like:</p><pre><code class="language-none">*** stack smashing detected ***: julia terminated</code></pre><p>An excerpt of the stack trace is:</p><pre><code class="language-none">umfdl_local_search at /mnt/scratch/common/julia/0.4/bin/../lib/julia/libumfpack.so (unknown line)
umfdl_kernel at /mnt/scratch/common/julia/0.4/bin/../lib/julia/libumfpack.so (unknown line)
umfpack_dl_numeric at /mnt/scratch/common/julia/0.4/bin/../lib/julia/libumfpack.so (unknown line)
umfpack_numeric! at sparse/umfpack.jl:168
_linearSolve at /home/creanj/pkgtest/v0.4/PDESolver/src/linearsolvers/ls_standard.jl:292
linearSolve at /home/creanj/pkgtest/v0.4/PDESolver/src/Utils/parallel.jl:312
newtonInner at util.jl:179</code></pre><p>To avoid this problem, see the <code>SKYLAKE_STACKSMASH</code> the <code>src/linearsolver/ls_standard.jl</code> file.</p><h3><a class="nav-anchor" id="Building-Julia-Offline-1" href="#Building-Julia-Offline-1">Building Julia Offline</a></h3><p>Building Julia on a system that cannot access the internet is a little bit different than build on a regular computer.  The approach is</p><p>On a computer with internet access</p><ul><li><p>clone the Julia repository</p></li><li><p>checkout the version of Julia you want to build</p></li><li><p>run <code>make -C deps getall</code> to download the source tarballs for all the things Julia builds during its build process</p></li><li><p>create a tarball of the julia directory</p></li><li><p>copy the julia tarball to the offline system</p></li></ul><p>On the system without internet access</p><ul><li><p>extract the julia tarball</p></li><li><p>add the line <code>prefix=/path/to/installation/directory</code> to the file <code>Make.user</code> (create the file if it does not exist</p></li><li><p>run <code>make</code> (or parallel <code>make</code> with the <code>-j</code> switch</p></li><li><p>make the directories <code>julia/doc/_build/html/en</code></p></li><li><p>create the file <code>julia/doc/_build/html/en/index.html</code></p></li><li><p>run <code>make install</code></p></li></ul><p>The purpose of creating the <code>index.html</code> file is that it will trick the Julia build system into not building the documentation.  This is necessary because build documentation requires downloading several Julia packages from the internet.</p><p>After <code>make install</code> has finished, the julia directory can be deleted, which can save a lot of disk space on the filesystems used on clusers/supercomputers.</p><footer><hr/><a class="previous" href="build.html"><span class="direction">Previous</span><span class="title">Building PDESolver</span></a><a class="next" href="interfaces.html"><span class="direction">Next</span><span class="title">Code Interfaces</span></a></footer></article></body></html>
